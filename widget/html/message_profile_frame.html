<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <meta content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" name="viewport"/>
        <meta content="telephone=no,email=no,date=no,address=no" name="format-detection"/>
        <title>
        </title>
        <link href="../css/api.css" rel="stylesheet" type="text/css"/>
        <style type="text/css">
            html,body{
	        	height: 100%;
	        	background-color: transparent;
	        }
            body{
                padding: 0 10px 10px;
                box-sizing: border-box; 
            }
            .message{
	            height: 100%;
	            width: 100%;
	            background-color: #fff;
	            box-shadow: 0 2px 5px -1px #ccc;
                position: relative;
	        }
            .left{
                box-sizing: border-box; 
                position: absolute;
                top:0;
                left:0;
                height: 100%;
                width: 50px;
                padding: 18px 10px 0;
            }
            .left .user_img{
                width: 50px;
                height: 50px;
                border-radius: 50%;
                background: url(../image/logo.png) no-repeat center center;
                background-size: auto 25px;
                box-shadow: 0 1px 5px -1px #ccc;
            }
            .left .user_name{
                text-align: center;
                width: 100%;
                height: 36px;line-height: 36px;
                white-space: nowrap;
                overflow:hidden; 
                text-overflow:ellipsis;
                font-size: 12px;
                color: #666;
            }
            .content{
                margin-left: 70px;
                padding: 12px 6px;
            }
            .content h2{
                font-size: 14px;
                line-height: 24px;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
            }
            .content p{
                font-size: 12px;
                line-height: 18px;
                color: #828282;
                display: -webkit-box;
                -webkit-box-orient: vertical;
                -webkit-line-clamp: 3;
                overflow: hidden;
            }
            .active{
                background-color: #f5f5f5;
            }


        </style>
    </head>
    <body>
        <div class="message" tapmode="active" onclick="openMessageDetail()">
            <div class="left">
                <div class="user_img"></div>
                <div class="user_name" id="userName">发布者</div>
            </div>
            <div class="content">
                <h2 id="topic">主题</h2>
                <p id="content">活动内容...</p>
            </div>
        </div>
    </body>
    <script src="../script/api.js" type="text/javascript"></script>
    <script type="text/javascript">
        var message,messageId,userName,topic,content;
        apiready = function(){
            userName=$api.byId('userName');
            topic=$api.byId('topic');
            content=$api.byId('content');
            message=$api.dom(".message");
            changeMessageListener();
        };
        function changeMessageListener(){
            api.addEventListener({
                name: 'changeMessage'
            }, function(ret, err) {
                if (ret) {
                    var newret=ret.value.option;
                    $api.attr(message, 'id',newret.listId);
                    $api.text(userName, newret.userName);
                    $api.text(topic, newret.topic);
                    $api.text(content, newret.content);
                }
            });
        }    
        function openMessageDetail(){
            messageId=$api.attr(message, 'id');
            api.openWin({
                name: 'message_detail',
                url: './message_detail.html',
                animation:{
                    type:'movein',
                    subType :'from_bottom'
                },
                pageParam: {
                    id: messageId
                }
            });
        };
        
    </script>
</html>